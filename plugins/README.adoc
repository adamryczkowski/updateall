= Update-All Plugins
:toc:
:toc-placement: preamble

Plugin implementations for the update-all system.

== Overview

This package contains the plugin implementations for various package managers:

* **apt** - Debian/Ubuntu package manager
* **cargo** - Rust package manager (crates.io)
* **flatpak** - Linux application sandboxing and distribution
* **npm** - Node.js package manager (global packages)
* **pipx** - Python application installer
* **rustup** - Rust toolchain installer
* **snap** - Canonical's universal package manager

== Architecture

Each plugin extends the `BasePlugin` class from this package, which implements the `UpdatePlugin` interface from `update-all-core`:

[source,python]
----
from plugins.base import BasePlugin

class AptPlugin(BasePlugin):
    """Plugin for apt package manager."""

    @property
    def name(self) -> str:
        return "apt"

    @property
    def command(self) -> str:
        return "apt"

    async def _execute_update(self, config: PluginConfig) -> tuple[str, str | None]:
        # Execute apt update && apt upgrade
        # Returns (output, error_message) - error_message is None on success
        ...
----

The `BasePlugin` class provides:

* Automatic availability checking via `check_available()` (checks if `command` exists)
* Command execution with timeout via `_run_command()`
* Streaming support via `_run_command_streaming()`
* Structured logging integration

== Plugin Registry

Plugins are registered via entry points in `pyproject.toml`:

[source,toml]
----
[project.entry-points."update_all.plugins"]
apt = "plugins.apt:AptPlugin"
pipx = "plugins.pipx:PipxPlugin"
flatpak = "plugins.flatpak:FlatpakPlugin"
----

== Development

[source,bash]
----
# Install dependencies
just install

# Run tests
just test

# Run linting
just lint
----

== Testing

Each plugin has comprehensive tests including:

* Unit tests with mocked subprocess calls
* Integration tests (optional, require actual package managers)
* Timeout handling tests

== License

MIT License
